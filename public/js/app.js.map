{"version":3,"sources":["fb.js","app.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["// This is called with the results from from FB.getLoginStatus().\nfunction statusChangeCallback(response) {\n  statusChecker(response);\n}\n\n// This function is called when someone finishes with the Login\n// Button.  See the onlogin handler attached to it in the sample\n// code below.\nfunction checkLoginState() {\n  // FB.getLoginStatus(function(response) {\n  //   statusChangeCallback(response);\n  // });\n  $.cookie('first_word', $('#canvasForm input[name=\"first\"]').val());\n  $.cookie('second_word', $('#canvasForm input[name=\"second\"]').val());\n  if( navigator.userAgent.match('CriOS') ){    \n      window.open('https://www.facebook.com/dialog/oauth?client_id='+ _globalObj._facebook_app_id +'&redirect_uri='+ document.location.href + '&scope=email', '', null);\n  }else{\n    FB.login(function(response) {\n      statusChecker(response);\n    }, {scope: 'public_profile,email'});\n  }\n}\n\n\n\n\nfunction statusChecker(response){\n\n  var buttonLogin = $('.btn-main.login');\n  var buttonLogout = $('.btn-main.logout');\n\n  if (response.status === 'connected') {\n    // Logged into your app and Facebook.\n    loginEvents();\n    buttonLogin.hide();\n    buttonLogout.show();\n    // Set status\n    _globalObj._login_status  = true;\n    \n\n    // logInToBackend(response.authResponse.userID);\n  } else if (response.status === 'not_authorized') {\n  \t_globalObj._login_status  = false\n    // The person is logged into Facebook, but not your app.\n    // document.getElementById('status').innerHTML = 'Please log ' +\n    // 'into this app.';\n\n  } else {\n    // The person is not logged into Facebook, so we're not sure if\n    // they are logged into this app or not.\n    _globalObj._login_status  = false\n    buttonLogin.show();\n    buttonLogout.hide();\n\n    // document.getElementById('status').innerHTML = 'Please log ' +\n    // 'into Facebook.';\n  }\n}\n\nwindow.fbAsyncInit = function() {\n  FB.init({\n    appId      : _globalObj._facebook_app_id,\n  cookie     : true,  // enable cookies to allow the server to access\n                      // the session\n  xfbml      : true,  // parse social plugins on this page\n  version    : 'v2.2' // use version 2.2\n});\n// Now that we've initialized the JavaScript SDK, we call\n// FB.getLoginStatus().  This function gets the state of the\n// person visiting this page and can return one of three states to\n// the callback you provide.  They can be:\n//\n// 1. Logged into your app ('connected')\n// 2. Logged into Facebook, but not your app ('not_authorized')\n// 3. Not logged into Facebook and can't tell if they are logged into\n//    your app or not.\n//\n// These three cases are handled in the callback function.\n\nFB.getLoginStatus(function(response) {\n  statusChangeCallback(response);\n});\n\n};\n\n// Load the SDK asynchronously\n(function(d, s, id) {\n  var js, fjs = d.getElementsByTagName(s)[0];\n  if (d.getElementById(id)) return;\n  js = d.createElement(s); js.id = id;\n  js.src = \"//connect.facebook.net/en_US/sdk.js\";\n  fjs.parentNode.insertBefore(js, fjs);\n}(document, 'script', 'facebook-jssdk'));\n\n// Here we run a very simple test of the Graph API after login is\n// successful.  See statusChangeCallback() for when this call is made.\nfunction loginEvents() {\n  FB.api('/me', function(response) {\n    console.log('response', response);\n    logInToBackend(response);\n    updateResponseText(response);\n  });\n}\n\nfunction loadImage(response){\n  var profileImageURL = 'https://graph.facebook.com/'+ response +'/picture?width=720&height=720';\n  downloadImageForCanvas(profileImageURL);\n  $('.img-color img').attr('src',profileImageURL);  \n  $(\"#hiddenToken\").val(_globalObj._token);\n}\n\nfunction downloadImageForCanvas(url){\n  console.log('Download the image ');\n  var data = {\n      \"_token\" : _globalObj._token,\n      \"url\" : url\n    }\n\n  $.ajax({\n    type: 'POST',\n    url: '/save-profile',\n    data: data,\n    dataType: 'text',\n    success:function(data){\n      console.log(data);\n     $('#profileImage').val(data);\n\n     if($('#picture-steps').length){\n       if($('#picture-steps').steps('getCurrentIndex') == 1){\n             setTimeout(function(){\n               $('#picture-steps').steps('next');\n             }, 500);\n       }\n     }\n    },\n    error:function(){\n      // failed request; give feedback to user\n      console.log(\"error saving profile image\");\n    }\n  });\n\n}\n\nfunction updateResponseText(response){\n  // document.getElementById('status').innerHTML =\n  // 'Thanks for logging in, ' + response.name + '!';\n}\n\nfunction logInToBackend(response){\n  console.log('log in user with fbID: ' + response.id)\n  var data = {\n    \"_token\" : _globalObj._token,\n    \"facebook_user_id\" : response.id,\n    \"name\" : response.name,\n    \"email\" : \"placeholder@gmail.com\"\n  }\n  sendAjaxLogInRequest(data);\n\n}\n\nfunction logOutOfBackend(){\n  console.log('log out user with fbID');\n  var data = {\n    \"_token\" : _globalObj._token\n  }\n  sendAjaxLogOutRequest();\n\n}\n\nfunction sendAjaxLogInRequest(data){\n  $.ajax({\n    type: 'POST',\n    url: '/login',\n    data: data,\n    dataType: 'text',\n    success:function(data){\n      console.log('You are logged in');\n      console.log('data:', data);\n      loadImage(data);\n    },\n    error:function(){\n        // failed request; give feedback to user\n        console.log(\"error data\");\n      }\n    });\n\n}\n\nfunction sendAjaxLogOutRequest(data){\n  $.ajax({\n    type: 'GET',\n    url: '/logout',\n    dataType: 'text',\n    success:function(data){\n      console.log('You are logged out');\n      console.log('data:', data);\n    },\n    error:function(){\n        // failed request; give feedback to user\n        console.log(\"error data\");\n      }\n    });\n\n}\n\n\n\n$(function(){\n  var buttonLogin = $('.btn-main.login');\n  var buttonLogout = $('.btn-main.logout');\n  buttonLogin.show();\n  buttonLogout.hide();\n\n  $(document).delegate('#fbLogin','click', function(e){\n\t  e.preventDefault();\n\t  checkLoginState();\n\t });\n\n  // Facebook logout event\n  $(document).delegate('#fbLogout','click', function(e){\n   e.preventDefault();\n   console.log('you clicked the fb logout');\n   FB.logout(function(response) {\n    var buttonLogin = $('.btn-main.login');\n    var buttonLogout = $('.btn-main.logout');\n   \t// Set global status\n   \t_globalObj._login_status  = false\n\n    $('.img-color img').attr('src','');\n    $('#profileImage').val('');\n    buttonLogin.show();\n    buttonLogout.hide();\n    logOutOfBackend();\n\n    // document.getElementById('status').innerHTML = 'Please log ' +\n    // 'into Facebook.';\n  });\n });\n});","// Document ready\njQuery(document).ready(function($){\n\n\n\t/*\n\t\tDiagonal cut across homepage\n\t*/\n\n\t$('#intro').height($(window).height() - 80);\n\t$('section .cut').each(function() {\n\t  if ($(this).hasClass('cut-top'))\n\t    $(this).css('border-right-width', $(this).parent().width() + \"px\");\n\t  else if ($(this).hasClass('cut-bottom'))\n\t    $(this).css('border-left-width', $(this).parent().width() + \"px\");\n\t});\n\n\n\n\t/*\n\t\tSet up jQuery Steps for picture process\n\t\tjQuery Steps\n\t\thttps://github.com/rstaib/jquery-steps\n\t*/\n\n\tvar pictureSteps = $('#picture-steps');\n\tpictureSteps.steps({\n\t  headerTag: \"h2.sr-only\",\n\t  bodyTag: \"section\",\n\t  transitionEffect: \"fade\",\n\t  autoFocus: true,\n\t  saveState: true,\n\n\t  onStepChanging: function (event, currentIndex, newIndex) {\n\n\t  \tif (currentIndex > newIndex) {\n\t      return true;\n\t    }\n\n\t    // First slide with word selection\n\t  \tvar selectedWord = $('.selected-word.selected');\n\t\t\tif ( currentIndex == 0 && selectedWord.length > 1 ) {\n\t\t\t\treturn true;\n\t  \t}\n\n\t  \tif ( currentIndex == 0 && selectedWord.length <= 1 ) {\n\t  \t\t// Error\n\t  \t\t$('#modal-error').modal('show');\n\t  \t\t$('#modal-error .header').replaceWith('<h3 class=\"header text-center\">Please Select A Few More Words.</h3>');\n\t  \t\treturn false;\n\t  \t}\n\n\t  \tif ( currentIndex == 1 && _globalObj._login_status == true ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif ( currentIndex == 1 && newIndex == 2 && _globalObj._login_status == false ) {\n\t\t\t\t$('#modal-error').modal('show');\n\t\t  \t$('#modal-error .header').replaceWith('<h3 class=\"header text-center\">Please Login to Facebook</h3>');\n\t\t\t} else if ( currentIndex == 1 && newIndex == 0 && _globalObj._login_status == false ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t  },\n\t  onFinished: function (event, currentIndex) {\n\t   \t$('#canvasForm').submit();\n\t  }\n\t});\n\n\n\n\n\t/*\n\t\tSelecting a word for picture process\n\t*/\n\n\tvar sectionHalf    = $('#picture-steps-p-0 .step-half'),\n\t\t\tselectedWord   = $('.step-list ul > li > a'),\n\t\t\tsectionBottom  = $('#picture-steps-p-0 .step-bottom');\n\n\t// Add tranform on load for ie9\n\tsectionBottom.css({\n\t\t'-webkit-transform' : 'translateY(50%)',\n\t\t'-ms-transform' : 'translateY(50%)',\n\t\t'transform' : 'translateY(50%)'\n\t});\n\n\t// Expand half sextions\n\tsectionHalf.on('click', function() {\n\t\tvar sectionTop     = $('#picture-steps-p-0 .step-top'),\n\t\t    sectionTop     = $('#picture-steps-p-0 .step-top'),\n\t\t    sectionList    = $('.step-list');\n\n\t\tfunction toTop() {\n\t\t  sectionHalf.animate({\n\t\t    scrollTop: sectionHalf.offset().top - 100\n\t\t  }, 300);\n\t\t}\n\n\t  // When section is open\n\t  if ( $(this).hasClass('is-open') ) {\n\t  \t// Remove classes and go to top\n\t    $(this).removeClass('is-open').addClass('collapsed');\n\t    toTop();\n\t  } else {\n\t    $(this).addClass('is-open')\n\t    \t.removeClass('collapsed');\n\t  }\n\n\t  if ( sectionTop.hasClass('is-open') ) {\n\t  \tsectionBottom.css({\n\t\t\t\t'-webkit-transform' : 'translateY(100%)',\n\t\t\t\t'-ms-transform' : 'translateY(100%)',\n\t\t\t\t'transform' : 'translateY(100%)'\n\t\t\t});\n\t  } else {\n\t  \tsectionBottom.css({\n\t\t\t\t'-webkit-transform' : 'translateY(50%)',\n\t\t\t\t'-ms-transform' : 'translateY(50%)',\n\t\t\t\t'transform' : 'translateY(50%)'\n\t\t\t});\n\t  }\n\n\t  if ( sectionBottom.hasClass('is-open') ) {\n\n\t  \tsectionBottom.css({\n\t\t\t\t'-webkit-transform' : 'translateY(0)',\n\t\t\t\t'-ms-transform' : 'translateY(0)',\n\t\t\t\t'transform' : 'translateY(0)'\n\t\t\t});\n\n\t\t\tsectionTop.css({\n\t\t\t\t'-webkit-transform' : 'translateY(-10%)',\n\t\t\t\t'-ms-transform' : 'translateY(-10%)',\n\t\t\t\t'transform' : 'translateY(-10%)'\n\t\t\t});\n\t  } else {\n\t  \tsectionTop.css({\n\t\t\t\t'-webkit-transform' : 'translateY(0)',\n\t\t\t\t'-ms-transform' : 'translateY(0)',\n\t\t\t\t'transform' : 'translateY(0)'\n\t\t\t});\n\t  }\n\t});\n\n\t// Collect values for canvas\n\n  $('#positive-list  li > a').on('click', function(e){\n      e.preventDefault();\n      console.log($(this).text());\n      $('#canvasForm input[name=\"first\"]').val($(this).text());\n      $.cookie('first_word', $(this).text());\n  });\n\n  $('#negative-list  li > a').on('click', function(e){\n      e.preventDefault();\n      console.log($(this).text());\n      $('#canvasForm input[name=\"second\"]').val($(this).text());\n      $.cookie('second_word', $(this).text());\n  });\n\n\n\t// When a word is selected from list of words\n\tselectedWord.on('click', function(event) {\n\t  event.preventDefault();\n\n\t  var selectedWord = $(this).closest('.step-half').find('.selected-word').text();\n\t  \t\tselectedText = $(this).text(),\n\t  \t\tpictureWordFirst = $('.img-color .words span:first-child'),\n\t  \t\tpictureWordLast = $('.img-color .words span:last-child'),\n\t  \t\tclosestStep = $(this).closest('.step-half');\n\n\n\t  // Find closest selected word and replace it\n\t  closestStep.find('.selected-word')\n\t  \t.replaceWith('<span class=\"selected-word selected color-accent animated flipInX\">' + selectedText + '</span>');\n\n\t  // Update the words on the picture screen\n\t  if (closestStep.hasClass('step-top')) {\n\t  \tpictureWordFirst.text(selectedText);\n\t  \t$('#canvasForm input[name=\"first\"]').val(selectedText);\n\n\t  } else {\n\t  \tpictureWordLast.text(selectedText);\n\t  }\n\t});\n\n\n\n\t/*\n\t\tInitiate Color Picker\n\t*/\n\t// Color picker\n\t// http://www.bamdaa.com/demo/color-picker/\n\t$(\".cp-fullscreen\").colorPicker({\n\t\t// Get colors from json\n\t\tcolors: 'colors.json',\n\n\t\t// Fill background overlay\n\t  onSelect: function(ui, color){\n\t    $('.color-overlay').css('background-color', color);\n\t    console.log(color);\n\n\t    // Add to the form\n\t    $('#canvasForm input[name=\"color\"]').val(color);\n\t  }\n\t});\n\n\n\n\n\t/*\n\t\tVideo on homepage\n\t*/\n\t// Video controls\n\t$(\"#video-controls\").click(function() {\n\t  // Play video\n\t  var video = $(\"#video-promo\").get(0);\n\t  video.play();\n\t  // Fade out overlay\n\t  $(this).fadeOut();\n\t  return false;\n\t});\n\t// Allow controls on hover\n\t$('#video-promo').hover(function toggleControls() {\n\t  if (this.hasAttribute(\"controls\")) {\n\t    this.removeAttribute(\"controls\")\n\t  } else {\n\t    this.setAttribute(\"controls\", \"controls\")\n\t  }\n\t});\n\n\n\n\t/*\n\t\tReturn user to color screen when they come back from login\n\t*/\n\tif($.cookie('first_word') != undefined){\n    console.log('we have a cookie set');\n    if($('#picture-steps').length){\n          if($('#picture-steps').steps('getCurrentIndex') == 1){\n                setTimeout(function(){\n                  $('#picture-steps').steps('next');\n                }, 500);\n          }\n     }\n    setWordsOnImageFromCookie($.cookie('first_word'), $.cookie('second_word'));\n  }\n\n\n\n  /*\n  \tOn scroll little helper div\n  */\n\tvar offset = 300,\n\t\toffset_opacity = 1200,\n\t\tscroll_top_duration = 700,\n\t\t$helpPop = $('.helpPop');\n\n\t$(window).scroll(function(){\n\t\t( $(this).scrollTop() > offset ) ? $helpPop.addClass('is-visible') : $helpPop.removeClass('is-visible fade-out');\n\t\tif( $(this).scrollTop() > offset_opacity ) {\n\t\t\t$helpPop.addClass('fade-out');\n\t\t}\n\t});\n\n\t//smooth scroll to top\n\t$helpPop.on('click', function(event){\n\t\tevent.preventDefault();\n\n\t\t// Show a modal\n\t\t$('#modal-help').modal('show');\n\n\t\t// Back to top functionality if we evey wanna switch it\n\t\t// $('body,html').animate({\n\t\t// \tscrollTop: 0 ,\n\t\t//  \t}, scroll_top_duration\n\t\t// );\n\t});\n\n});\n\n\n\n// Window ready\n$(window).on('load', function() {\n\n  // Preloader gif\n  $('.preloader').addClass('animated fadeOut').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {\n    $('.preloader').hide();\n  });\n\n\tvar introTable = $('.intro-tables');\n  introTable.addClass('animated fadeInUp').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend');\n  setTimeout(function(){\n\t\tintroTable.addClass('visible');\n\t}, 200);\n\n});\n\n\n\n\n\nfunction setWordsOnImageFromCookie(first,second){\n\tvar pictureWordFirst = $('.img-color .words span:first-child'),\n\tpictureWordLast = $('.img-color .words span:last-child'),\n\tlistWordFirst = $('.step-top span.selected-word'),\n\tlistWordLast = $('.step-bottom span.selected-word');\n\n\tpictureWordFirst.text(first);\n\tpictureWordLast.text(second);\n\tlistWordFirst.addClass('selected color-accent animated flipInX');\n\tlistWordLast.addClass('selected color-accent animated flipInX');\n\tlistWordFirst.text(first);\n\tlistWordLast.text(second);\n\n\t$('#canvasForm input[name=\"first\"]').val(first);\n\t$('#canvasForm input[name=\"second\"]').val(second);\n}\n\n\n"],"sourceRoot":"/source/"}